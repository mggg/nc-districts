{"version":3,"sources":["logo.svg","components/ChooseLayers.js","colors.js","components/AgeHistogram.js","components/IncomeHistogram.js","components/ElectionTable.js","components/RaceDataBrowser.js","components/EnvLegend.js","components/MedLegend.js","components/UniLegend.js","layers/Layer.js","layers/Hover.js","pages/Map.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","ChooseLayers","props","state","selectItem","clickTest","bind","event","index","preventDefault","this","disabled","setState","switchLayer","className","labels","map","label","i","key","href","onClick","e","name","React","Component","changeColorLuminance","hex","lum","String","replace","length","c","rgb","parseInt","substr","Math","round","min","max","toString","getUnitColorProperty","parts","unitColorStyle","part","id","color","reduce","list","pair","hoverColor","colorAndHoverAlt","incomeColors","ageColors","partyRGBColors","densityColors","demoGroup","enviroPaint","AgeHistogram","totals","keys","selected","median_point","median_age","col_max_height","Object","properties","filter","p","indexOf","sort","a","b","split","forEach","k","tot_pop","blockgroup","TOTPOP","B01002_001","median_pop","kdex","cols","age_range","years","height","width","style","background","is_median","toFixed","IncomeHistogram","median_name","x","tot_hh","ind","median_hh","floor","elections","ElectionTable","total_votes","precinct","value","selectedElection","onChange","changeElection","toLocaleString","raceGroups","demoColors","num","RaceDataBrowser","focusRace","changeFocus","r","textAlign","colorDot","EnvLegend","Layer","layer","adder","sourceId","source","type","sourceLayer","addLayer","getFeature","removeLayer","opacity","isText","setPaintProperty","getPaintProperty","featureId","setFeatureState","getFeatureState","querySourceFeatures","queryRenderedFeatures","layers","feature","args","on","off","callback","isSourceLoaded","handler","HoverWithRadius","radius","setMapSelection","hoveredFeatures","featureState","hover","features","deactivatedHover","box","point","southwest","y","boxAround","hoverOff","hoverOn","hoveredFeature","onMouseMove","onMouseLeave","mouseover","window","mapboxgl","accessToken","dataLayers","units","Map","mapLoaded","currentColorLayer","currentUnitLayer","unitLayers","pointLayers","mapSelection","state_configs","nc","center","zoom","container","refs","attributionControl","pitchWithRotate","dragPan","touchZoomRotate","geocoder","MapboxGeocoder","marker","addControl","NavigationControl","fetch","then","res","json","gj","addSource","data","paint","url","borderPrecincts","fillPrecincts","cursorPrecincts","borderBGs","fillBGs","cursorBGs","activate","blockgroups","blockgroups_border","blockgroups_cursor","precincts","precincts_border","precincts_cursor","paintAge","items","demKey","repKey","newSelection","target","newElection","newFocus","layer_id","selectLayer","remove","addToMap","deactivate","paintIncome","paintRace","activeLayer","ref","App","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.51a947f5.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","import React from 'react'\n\nexport default class ChooseLayers extends React.Component {\n  constructor(props) {\n    super();\n\n    this.state = {\n      selectItem: 0\n    }\n\n    this.clickTest = this.clickTest.bind(this);\n  }\n\n  clickTest (event, index) {\n    event.preventDefault();\n    if (!this.props.disabled) {\n      this.setState({ selectItem: index });\n      this.props.switchLayer(index);\n    }\n  }\n\n  render () {\n    return <nav className=\"navbar navbar-expand-lg navbar-dark bg-primary\">\n      <ul className=\"navbar-nav mr-auto\">\n        {this.props.labels.map((label, i) =>\n          <li className=\"nav-item\" key={i}>\n            <a\n              className={\"nav-link \" +\n                ((i === this.state.selectItem) ? \"active\" : \"\")}\n              href=\"#\"\n              onClick={(e) => { this.clickTest(e, i) }}\n            >\n              {label.name}\n            </a>\n          </li>)\n        }\n      </ul>\n    </nav>\n  }\n}\n","export function changeColorLuminance(hex, lum) {\n    // validate hex string\n    hex = String(hex).replace(/[^0-9a-f]/gi, \"\");\n    if (hex.length < 6) {\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    lum = lum || 0;\n\n    // convert to decimal and change luminosity\n    let rgb = \"#\",\n        c,\n        i;\n    for (i = 0; i < 3; i++) {\n        c = parseInt(hex.substr(i * 2, 2), 16);\n        c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n        rgb += (\"00\" + c).substr(c.length);\n    }\n\n    return rgb;\n}\n\nexport function getUnitColorProperty(parts) {\n    const unitColorStyle = [\n        \"match\",\n        [\"feature-state\", \"color\"],\n        ...parts\n            .map(part => [part.id, part.color])\n            .reduce((list, pair) => [...list, ...pair]),\n        \"rgba(0, 0, 0, 0)\"\n    ];\n\n    const hoveredUnitColorStyle = [\n        \"match\",\n        [\"feature-state\", \"color\"],\n        ...parts\n            .map(part => [part.id, part.hoverColor])\n            .reduce((list, pair) => [...list, ...pair]),\n        \"#aaaaaa\"\n    ];\n\n    const unitColorProperty = [\n        \"case\",\n        [\"boolean\", [\"feature-state\", \"hover\"], false],\n        hoveredUnitColorStyle,\n        unitColorStyle\n    ];\n\n    return unitColorProperty;\n}\n\nfunction colorAndHoverAlt(hex) {\n  return [\n    \"case\",\n    [\"==\", [\"feature-state\", \"hover\"], true],\n    changeColorLuminance(hex, -0.3),\n    hex\n  ]\n}\n\nexport const incomeColors = [\"case\",\n  [\"<\", [\"get\", \"B19013_001\"], 30000],\n  colorAndHoverAlt(\"#edf8fb\"),\n  [\"<\", [\"get\", \"B19013_001\"], 60000],\n  colorAndHoverAlt(\"#ccece6\"),\n  [\"<\", [\"get\", \"B19013_001\"], 90000],\n  colorAndHoverAlt(\"#99d8c9\"),\n  [\"<\", [\"get\", \"B19013_001\"], 120000],\n  colorAndHoverAlt(\"#66c2a4\"),\n  [\"<\", [\"get\", \"B19013_001\"], 150000],\n  colorAndHoverAlt(\"#2ca25f\"),\n  colorAndHoverAlt(\"#006d2c\")\n]\n\nexport const ageColors = [\"case\",\n  [\"<\", [\"get\", \"B01002_001\"], 20],\n  colorAndHoverAlt(\"#edf8fb\"),\n  [\"<\", [\"get\", \"B01002_001\"], 35],\n  colorAndHoverAlt(\"#ccece6\"),\n  [\"<\", [\"get\", \"B01002_001\"], 50],\n  colorAndHoverAlt(\"#99d8c9\"),\n  [\"<\", [\"get\", \"B01002_001\"], 65],\n  colorAndHoverAlt(\"#66c2a4\"),\n  [\"<\", [\"get\", \"B01002_001\"], 80],\n  colorAndHoverAlt(\"#2ca25f\"),\n  colorAndHoverAlt(\"#006d2c\"),\n]\n\nconst partyRGBColors = {\n  Democratic: [\n    0, \"rgba(0,0,0,0)\",\n    0.499, \"rgba(0,0,0,0)\",\n    0.5, \"rgba(249,249,249,0)\",\n    1, \"rgb(25, 118, 210)\" // 0x1976d2\n  ],\n  Democratic_hover: [\n    0, \"rgba(0,0,0,0)\",\n    0.499, \"rgba(0,0,0,0)\",\n    0.5, \"rgba(174,174,174,0.5)\",\n    1, \"rgb(18, 83, 147)\"\n  ],\n  Republican: [\n    0, \"rgba(0,0,0,0)\",\n    0.499, \"rgba(0,0,0,0)\",\n    0.5, \"rgba(249,249,249,0)\",\n    1, \"rgb(211, 47, 47)\" // 0xd32f2f\n  ],\n  Republican_hover: [\n    0, \"rgba(0,0,0,0)\",\n    0.499, \"rgba(0,0,0,0)\",\n    0.5, \"rgba(174,174,174,0.5)\",\n    1, \"rgb(148, 33, 33)\"\n  ],\n};\n\nexport function densityColors(demoGroup) {\n  return [\"case\",\n    [\"==\", [\"get\", \"TOTPOP\"], 0],\n      \"#ccc\", // no data\n      [\n        \"interpolate\",\n        [\"linear\"],\n        [\"/\", [\"get\", demoGroup[1]], [\"get\", \"TOTPOP\"]],\n        ...[0, \"rgba(200, 200, 255, 0)\",\n        (demoGroup[2] + 0.01), \"rgba(0, 0, 255, 0.6)\"]\n      ]\n  ]\n}\n\nexport function electionColors(demKey, repKey) {\n  return [\n    \"case\",\n    [\">\", [\"get\", demKey], [\"get\", repKey]],\n      [\"case\",\n        [\"==\", [\"feature-state\", \"hover\"], true],\n        [\n            \"interpolate\",\n            [\"linear\"],\n            [\"/\", [\"get\", demKey], [\"+\", [\"get\", demKey], [\"get\", repKey]]],\n            ...partyRGBColors[\"Democratic_hover\"],\n        ],\n        [\n            \"interpolate\",\n            [\"linear\"],\n            [\"/\", [\"get\", demKey], [\"+\", [\"get\", demKey], [\"get\", repKey]]],\n            ...partyRGBColors[\"Democratic\"],\n        ]\n      ],\n      [\"case\",\n        [\"==\", [\"feature-state\", \"hover\"], true],\n        [\n            \"interpolate\",\n            [\"linear\"],\n            [\"/\", [\"get\", repKey], [\"+\", [\"get\", demKey], [\"get\", repKey]]],\n            ...partyRGBColors[\"Republican_hover\"],\n        ],\n        [\n            \"interpolate\",\n            [\"linear\"],\n            [\"/\", [\"get\", repKey], [\"+\", [\"get\", demKey], [\"get\", repKey]]],\n            ...partyRGBColors[\"Republican\"],\n        ]\n      ]\n  ]\n}\n\nexport const enviroPaint = {\n  'circle-radius': 4,\n  'circle-color': [\n    'match',\n    ['get', 'CLASS_STATUS'],\n    'Title V', 'purple',\n    'Synthetic Minor', 'green',\n    'Small', 'red',\n    'Permit Exempt', 'blue',\n    'Registered', 'orange',\n    'Permit/Registration Pending', 'yellow',\n    '#ccc' // other\n  ]\n}\n","import React from 'react'\n\nimport {\n  ageColors\n} from '../colors'\n\nexport default function AgeHistogram(props) {\n  let totals = {},\n      keys = [],\n      selected = props.selected,\n      median_point = \"\",\n      median_age = 0,\n      col_max_height = 0\n\n  if (selected.length) {\n    keys = Object.keys(selected[0].properties)\n        .filter(p => p.indexOf(\"age_\") === 0)\n        .sort((a, b) => a.split(\"_\")[1].replace(\"lt\", \"0\") - b.split(\"_\")[1].replace(\"lt\", \"0\"))\n\n    keys.forEach(k => totals[k] = 0)\n\n    let tot_pop = 0;\n    selected.forEach((blockgroup) => {\n      keys.forEach(k => totals[k] += blockgroup.properties[k])\n      tot_pop += blockgroup.properties.TOTPOP\n      median_age += blockgroup.properties.TOTPOP * blockgroup.properties.B01002_001\n    })\n    median_age /= tot_pop\n\n    let median_pop = tot_pop / 2;\n    keys.forEach((k, kdex) => {\n      if (median_point === \"\") {\n        median_pop -= totals[k]\n        if (median_pop <= 0) {\n          median_point = kdex\n        }\n      }\n    })\n  }\n\n  let cols = keys.map(k => {\n    let age_range = k.replace(\"lt_5\", \"0_4\").replace(\"85_plu\", \"85_90\").split(\"_\"),\n        years = (age_range.length === 2) ? 1 : (age_range[2] - age_range[1] + 1),\n        height = totals[k] / years;\n    col_max_height = Math.max(col_max_height, height)\n    return { width: years * 6, height: height }\n  })\n\n  return <div>\n    <span>Layer: Median Age</span>\n    <div className=\"palette\">\n      {ageColors.filter(c => c[0] === \"case\").map((color, i) =>\n        <div className=\"square\" key={i} style={{background: color[3]}}>\n        </div>\n      )}\n    </div>\n    <div className=\"nums\">\n      {ageColors.filter(c => c[0] === \"<\").map((color, i) =>\n        <div className=\"square\" key={i}>\n          {i ? \"\" : \"< \"}\n          {color[2]}\n        </div>\n      )}\n      <div className=\"square\">\n        > {ageColors[ageColors.length - 3][2]}\n      </div>\n    </div>\n\n    <span>Source: US Census ACS (2018)</span>\n    <div className=\"histogram\">\n      {cols.map((c, kdex) => {\n        let is_median = (kdex === median_point);\n        return <div key={kdex} style={{\n          background: (is_median ? \"#888\" : \"#444\"),\n          width: c.width,\n          height: (c.height / col_max_height * 100)\n        }}>\n        </div>\n      })}\n    </div>\n    {cols.length\n      ? <div>\n        <small>Youngest to Oldest</small>\n        <br/>\n        <span>Median: {median_age ? median_age.toFixed(1) : \"N/A\"}</span>\n      </div>\n      : null\n    }\n  </div>\n}\n","import React from 'react'\n\nimport {\n  incomeColors\n} from '../colors'\n\nexport default function IncomeHistogram(props) {\n  let totals = [],\n      keys = [],\n      selected = props.selected,\n      median_point = \"\",\n      median_name = \"\",\n      col_max_height = 0\n\n  if (selected.length) {\n    keys = Object.keys(selected[0].properties)\n        .filter(p => p.indexOf(\"B19001_\") === 0)\n        .sort()\n\n    totals = keys.map(x => 0)\n\n    let tot_hh = 0;\n    selected.forEach((blockgroup) => {\n      keys.forEach((k, ind) => {\n        totals[ind] += blockgroup.properties[k]\n        tot_hh += blockgroup.properties[k]\n      })\n    })\n\n    let median_hh = tot_hh / 2;\n    totals.forEach((k, kdex) => {\n      col_max_height = Math.max(col_max_height, k)\n      if (median_point === \"\") {\n        median_hh -= k\n        if (median_hh <= 0) {\n          median_point = kdex\n          median_name = [\n            \"< 10k\",\n            \"10-15k\",\n            \"15-20k\",\n            \"20-25k\",\n            \"25-30k\",\n            \"30-35k\",\n            \"35-40k\",\n            \"40-45k\",\n            \"45-50k\",\n            \"50-60k\",\n            \"60-75k\",\n            \"75-100k\",\n            \"100-125k\",\n            \"125-150k\",\n            \"150-200k\",\n            \"> 200k\",\n          ][kdex]\n        }\n      }\n    })\n  }\n\n  return <div>\n    <span>Layer: Median Household Income</span>\n    <div className=\"palette\">\n      {incomeColors.filter(c => c[0] === \"case\").map((color, i) =>\n        <div className=\"square\" key={i} style={{background: color[3]}}>\n        </div>\n      )}\n    </div>\n    <div className=\"nums\">\n      {incomeColors.filter(c => c[0] === \"<\").map((color, i) =>\n        <div className=\"square\" key={i}>\n          {i ? \"\" : \"< \"}\n          {Math.floor(color[2] / 1000)}k\n        </div>\n      )}\n      <div className=\"square\">\n        > {Math.floor(incomeColors[incomeColors.length - 3][2] / 1000)}k\n      </div>\n    </div>\n\n    <span>Source: US Census ACS (2018)</span>\n    <div className=\"histogram\">\n      {totals.map((c, kdex) => {\n        let is_median = (kdex === median_point);\n        return <div key={kdex} style={{\n          background: (is_median ? \"#888\" : \"#444\"),\n          width: 24,\n          height: (c / col_max_height * 100)\n        }}>\n        </div>\n      })}\n    </div>\n    {totals.length\n      ? <div>\n        <small>Least to Most</small>\n        <br/>\n        {median_name ?\n          <span>Median: {median_name.replace(\"age_\", \"\").replace(\"_\", \" â€“ \")}</span>\n          : null\n        }\n      </div>\n      : null\n    }\n  </div>\n}\n","import React from 'react'\n\nexport const elections = [\n  // year, position, DEM key, REP key\n  [2016, \"President\", \"EL16G_PR_D\", \"EL16G_PR_R\"],\n  [2016, \"Governor\", \"EL16G_GV_D\", \"EL16G_GV_R\"],\n  [2016, \"US Senate\", \"EL16G_US_1\", \"EL16G_USS_\"],\n  [2014, \"US Senate\", \"EL14G_US_1\", \"EL14G_USS_\"],\n  [2012, \"President\", \"EL12G_PR_D\", \"EL12G_PR_R\"],\n  [2012, \"Governor\", \"EL12G_GV_D\", \"EL12G_GV_R\"],\n  [2008, \"Governor\", \"EL08G_GV_D\", \"EL08G_GV_R\"],\n  [2008, \"US Senate\", \"EL08G_USS_\", \"EL08G_US_1\"],\n  [2010, \"US Senate\", \"EL10G_USS_\", \"EL10G_US_1\"]\n]\n\nexport function ElectionTable(props) {\n  let selected = props.selected,\n      total_votes = {}\n\n  if (selected.length) {\n    let keys = Object.keys(selected[0].properties)\n      .filter(p => p.indexOf(\"EL\") === 0)\n\n    keys.forEach(k => total_votes[k] = 0)\n\n    selected.forEach(precinct => {\n      keys.forEach(k => total_votes[k] += precinct.properties[k])\n    })\n  }\n\n  return <div>\n    <span>Layer: Vote Partisanship</span>\n    <p>Source: MGGG, North Carolina General Assembly, National Historic GIS (NHGIS)</p>\n    <br/>\n    <select value={props.selectedElection} onChange={props.changeElection}>\n      {elections.map((e, i) =>\n        <option key={i} value={i}>{e[0] + \" \" + e[1]}</option>\n      )}\n    </select>\n    <br/><br/>\n    <span>Two-party vote share</span>\n    <table className=\"table\">\n      <thead>\n        <tr>\n          <th>Year</th>\n          <th>Position</th>\n          <th>Democratic</th>\n          <th>Republican</th>\n        </tr>\n      </thead>\n      <tbody>\n        {elections.map((e, i) =>\n          <tr key={i}>\n            <td>{e[0]}</td>\n            <td>{e[1]}</td>\n            <td className=\"digits\">{(total_votes[e[2]] || 0).toLocaleString()}</td>\n            <td className=\"digits\">{(total_votes[e[3]] || 0).toLocaleString()}</td>\n          </tr>\n        )}\n      </tbody>\n    </table>\n  </div>\n}\n","import React from 'react'\n\nexport const raceGroups = [\n  // display name, shapefile key, maximum % (0.01-1.00)\n  ['White', 'NH_WHITE', 1.00],\n  ['Black', 'NH_BLACK', 1.00],\n  ['Hispanic', 'HISP', 0.81],\n  ['Asian', 'NH_ASIAN', 0.65],\n  ['American Indian', 'NH_AMIN', 0.93],\n  ['Native Hawaiian or Pacific Islander', 'NH_NHPI', 0.02],\n  ['Other', 'NH_OTHER', 0.20],\n  ['2+ Races', 'NH_2MORE', 0.13],\n]\n\nconst demoColors = [0,1,2,3,4,5,6,7,8].map((num,i) => `rgba(${200*(8-i)/8}, ${200*(8-i)/8}, 255, ${i/8*0.6})`)\n\nexport function RaceDataBrowser(props) {\n  let selected = props.selected;\n\n  return <div>\n    <span>Source: US Census ACS (2018)</span>\n    <br/>\n    <select value={props.focusRace} onChange={props.changeFocus}>\n      {raceGroups.map((r, i) =>\n        <option value={i} key={i}>{r[0]}</option>\n      )}\n    </select>\n\n    <br/><br/>\n\n    <div className=\"palette gradient\" style={{background:\"linear-gradient(to right, rgba(200, 200, 255, 0), rgba(0, 0, 255, 0.6))\"}}>\n    </div>\n    <div className=\"nums\">\n      {demoColors.map((color, i) =>\n        <div className=\"square\" key={i}>\n          {(Math.min(1, raceGroups[props.focusRace][2] + 0.01) * i / 0.08).toFixed(1)}\n        </div>\n      )}\n      <div className=\"palette\" style={{textAlign: \"center\", width: 330 }}>\n        % of blockgroup\n      </div>\n    </div>\n  </div>\n}\n","import React from 'react'\n\nconst colorDot = (color) => <span style={{ background: color }}></span>\n\nexport default function EnvLegend(props) {\n  let selected = props.selected;\n\n  return <div>\n    <span>Layer: Environment</span>\n    <br/>\n    <span>Source: North Carolina Department of Environmental Quality</span>\n    <br/>\n    <span>Environmental Map Key</span>\n    <br/>\n    <ul className=\"colorList\">\n      <li>{colorDot('purple')} Title V</li>\n      <li>{colorDot('green')} Synthetic Minor</li>\n      <li>{colorDot('red')} Small</li>\n      <li>{colorDot('blue')} Permit Exempt</li>\n      <li>{colorDot('orange')} Registered</li>\n      <li>{colorDot('yellow')} Permit/Registration Pending</li>\n    </ul>\n  </div>\n}\n","import React from 'react'\n\nexport default function EnvLegend(props) {\n  let selected = props.selected;\n\n\n  return <div>\n    <span>Layer: Hospitals</span>\n    <br/>\n    <span>Source: Homeland Infrastructure Foundation</span>\n\n  </div>\n}\n","import React from 'react'\n\nexport default function EnvLegend(props) {\n  let selected = props.selected;\n\n\n  return <div>\n    <span>Layer: Colleges & Universities</span>\n    <br/>\n    <span>Source: Homeland Infrastructure Foundation</span>\n\n  </div>\n}\n","// The addBelowLabels method gives the right look on the Mapbox \"streets\" basemap,\r\n// while addBelowSymbols gives the right look on the \"light\" basemap.\r\n\r\n/**\r\n * Add the layer to the map below the first label layer (e.g. street names).\r\n * @param {mapboxgl.Map} map\r\n * @param {Layer} layer\r\n */\r\nexport function addBelowLabels(map, layer) {\r\n    const layers = map.getStyle().layers;\r\n    const firstSymbolId = getFirstLabelId(layers);\r\n    map.addLayer(layer, firstSymbolId);\r\n}\r\n\r\nexport function addBelowSymbols(map, layer) {\r\n    const layers = map.getStyle().layers;\r\n    const firstSymbolId = getFirstSymbolId(layers);\r\n    map.addLayer(layer, firstSymbolId);\r\n}\r\n\r\n/**\r\n * @param {Object[]} layers list of layers from the Mapbox map's style\r\n * @returns {string} id of the first id with \"label\" in the name\r\n */\r\nfunction getFirstLabelId(layers) {\r\n    for (let i = 0; i < layers.length; i++) {\r\n        if (layers[i].id.includes(\"label\")) {\r\n            return layers[i].id;\r\n        }\r\n    }\r\n}\r\n\r\nfunction getFirstSymbolId(layers) {\r\n    for (let i = 0; i < layers.length; i++) {\r\n        if (layers[i].type === \"symbol\") {\r\n            return layers[i].id;\r\n        }\r\n    }\r\n}\r\n\r\n/** A layer on a Mapbox map. */\r\nexport default class Layer {\r\n    /**\r\n     * @param {mapboxgl.Map} map to add the layer to\r\n     * @param {Object} layer a Layer object obeying the Mapbox style specification\r\n     * @param {function} [adder] a function (map, layer) -> void that adds the layer\r\n     *  to the map.\r\n     */\r\n    constructor(map, layer, adder) {\r\n        this.map = map;\r\n        this.layer = layer;\r\n        this.id = layer.id;\r\n        this.sourceId = layer.source;\r\n        this.type = layer.type;\r\n        this.sourceLayer = layer[\"source-layer\"];\r\n\r\n        if (adder) {\r\n            adder(map, layer);\r\n        } else if (map) {\r\n            map.addLayer(layer);\r\n        }\r\n\r\n        this.getFeature = this.getFeature.bind(this);\r\n    }\r\n    addToMap(map) {\r\n      if (map && !this.map) {\r\n        this.map = map;\r\n        map.addLayer(this.layer);\r\n      }\r\n    }\r\n    remove() {\r\n      if (this.map) {\r\n        this.map.removeLayer(this.id);\r\n        this.map = null;\r\n      }\r\n    }\r\n    setOpacity(opacity, isText) {\r\n        this.setPaintProperty(`${isText ? \"text\" : this.type.replace(\"symbol\", \"icon\")}-opacity`, opacity);\r\n    }\r\n    setColor(color) {\r\n        this.setPaintProperty(`${this.type}-color`, color);\r\n    }\r\n    getColor() {\r\n        return this.getPaintProperty(`${this.type}-color`);\r\n    }\r\n    setPaintProperties(properties) {\r\n        for (let name in properties) {\r\n            this.setPaintProperty(name, properties[name]);\r\n        }\r\n    }\r\n    setFeatureState(featureId, state) {\r\n        this.map.setFeatureState(\r\n            {\r\n                source: this.sourceId,\r\n                sourceLayer: this.sourceLayer,\r\n                id: featureId\r\n            },\r\n            state\r\n        );\r\n    }\r\n    setPaintProperty(name, value) {\r\n        this.map.setPaintProperty(this.id, name, value);\r\n    }\r\n    getPaintProperty(name) {\r\n        return this.map.getPaintProperty(this.id, name);\r\n    }\r\n    getFeatureState(featureId) {\r\n        return this.map.getFeatureState({\r\n            source: this.sourceId,\r\n            sourceLayer: this.sourceLayer,\r\n            id: featureId\r\n        });\r\n    }\r\n    getFeature(featureId) {\r\n        const features = this.map.querySourceFeatures(this.sourceId, {\r\n            sourceLayer: this.sourceLayer,\r\n            filter: [\"==\", [\"id\"], featureId]\r\n        });\r\n        return features[0];\r\n    }\r\n    queryRenderedFeatures() {\r\n        return this.map.queryRenderedFeatures(null, { layers: [this.id] });\r\n    }\r\n    querySourceFeatures() {\r\n        return this.map.querySourceFeatures(this.sourceId, {\r\n            sourceLayer: this.sourceLayer\r\n        });\r\n    }\r\n    getAssignment(featureId) {\r\n        return this.getFeatureState(featureId).color;\r\n    }\r\n    setAssignment(feature, part) {\r\n        this.setFeatureState(feature.id, {\r\n            ...feature.state,\r\n            color: part\r\n        });\r\n    }\r\n    on(type, ...args) {\r\n        this.map.on(type, this.id, ...args);\r\n    }\r\n    off(type, ...args) {\r\n        this.map.off(type, this.id, ...args);\r\n    }\r\n    untilSourceLoaded(callback) {\r\n        if (this.map.isSourceLoaded(this.sourceId)) {\r\n            return callback();\r\n        }\r\n        const handler = () =>\r\n            callback(() => this.map.off(\"sourcedata\", handler));\r\n        this.map.on(\"sourcedata\", handler);\r\n    }\r\n}\r\n","export class Hover {\r\n    constructor(layer) {\r\n        this.layer = layer;\r\n\r\n        this.hoveredFeature = null;\r\n        this.deactivatedHover = false;\r\n\r\n        this.onMouseMove = this.onMouseMove.bind(this);\r\n        this.onMouseLeave = this.onMouseLeave.bind(this);\r\n        this.hoverOff = this.hoverOff.bind(this);\r\n    }\r\n    hoverOff() {\r\n        if (this.hoveredFeature !== null) {\r\n            this.layer.setFeatureState(this.hoveredFeature.id, {\r\n                ...this.hoveredFeature.state,\r\n                hover: false\r\n            });\r\n            this.hoveredFeature = null;\r\n        }\r\n    }\r\n    hoverOn(feature) {\r\n        this.hoveredFeature = feature;\r\n        if (!this.deactivatedHover) {\r\n            this.layer.setFeatureState(feature.id, {\r\n                ...feature.state,\r\n                hover: true\r\n            });\r\n        }\r\n    }\r\n    onMouseMove(e) {\r\n        if (e.features.length > 0) {\r\n            this.hoverOff();\r\n            this.hoverOn(e.features[0]);\r\n        }\r\n    }\r\n    onMouseLeave() {\r\n        this.hoverOff();\r\n    }\r\n    activate(mouseover) {\r\n        if (mouseover) {\r\n            this.deactivatedHover = false;\r\n            return;\r\n        }\r\n        this.layer.on(\"mousemove\", this.onMouseMove);\r\n        this.layer.on(\"mouseleave\", this.onMouseLeave);\r\n        this.layer.on(\"touchmove\", this.onMouseMove);\r\n        this.layer.on(\"touchend\", this.onMouseLeave);\r\n    }\r\n    deactivate(mouseover) {\r\n        if (mouseover) {\r\n            this.deactivatedHover = true;\r\n            return;\r\n        }\r\n        this.layer.off(\"mousemove\", this.onMouseMove);\r\n        this.layer.off(\"mouseleave\", this.onMouseLeave);\r\n        this.layer.off(\"touchmove\", this.onMouseMove);\r\n        this.layer.off(\"touchend\", this.onMouseLeave);\r\n    }\r\n}\r\n\r\nexport class HoverWithRadius extends Hover {\r\n    constructor(layer, radius, setMapSelection) {\r\n        super(layer);\r\n\r\n        this.radius = radius;\r\n        this.hoveredFeatures = [];\r\n        this.setMapSelection = setMapSelection;\r\n    }\r\n    hoverOff() {\r\n        this.hoveredFeatures.forEach(feature => {\r\n            let featureState = this.layer.getFeatureState(feature.id);\r\n            this.layer.setFeatureState(feature.id, {\r\n                ...featureState,\r\n                hover: false\r\n            });\r\n        });\r\n        this.hoveredFeatures = [];\r\n        this.setMapSelection(this.hoveredFeatures);\r\n    }\r\n    hoverOn(features) {\r\n        this.hoveredFeatures = features;\r\n        if (!this.deactivatedHover) {\r\n            this.hoveredFeatures.forEach(feature => {\r\n                this.layer.setFeatureState(feature.id, {\r\n                    ...feature.state,\r\n                    hover: true\r\n                });\r\n            });\r\n        }\r\n        this.setMapSelection(this.hoveredFeatures);\r\n    }\r\n    onMouseMove(e) {\r\n        const box = boxAround(e.point, this.radius);\r\n        const features = this.layer.map.queryRenderedFeatures(box, {\r\n            layers: [this.layer.id]\r\n        });\r\n        if (features.length > 0) {\r\n            this.hoverOff();\r\n            this.hoverOn(features);\r\n        }\r\n    }\r\n}\r\n\r\nfunction boxAround(point, radius) {\r\n    const southwest = [point.x + radius, point.y + radius];\r\n    const northeast = [point.x - radius, point.y - radius];\r\n    return [northeast, southwest];\r\n}\r\n","import React from 'react'\n\n// UI components\nimport ChooseLayers from '../components/ChooseLayers'\nimport AgeHistogram from '../components/AgeHistogram'\nimport IncomeHistogram from '../components/IncomeHistogram'\nimport { elections, ElectionTable } from '../components/ElectionTable'\nimport { raceGroups, RaceDataBrowser } from '../components/RaceDataBrowser'\nimport EnvLegend from '../components/EnvLegend'\nimport MedLegend from '../components/MedLegend'\nimport UniLegend from '../components/UniLegend'\n\n// map management\nimport Layer from '../layers/Layer'\nimport { HoverWithRadius } from '../layers/Hover'\nimport {\n  changeColorLuminance,\n  getUnitColorProperty,\n  enviroPaint,\n  ageColors,\n  incomeColors,\n  electionColors,\n  densityColors,\n} from '../colors'\n\nwindow.mapboxgl.accessToken = \"pk.eyJ1IjoiZGlzdHJpY3RyIiwiYSI6ImNqbjUzMTE5ZTBmcXgzcG81ZHBwMnFsOXYifQ.8HRRLKHEJA0AismGk2SX2g\";\n\nconst dataLayers = [\n  {\n    name: \"Age\",\n    units: \"blockgroups\",\n  },\n  {\n    name: \"Income\",\n    units: \"blockgroups\",\n  },\n  {\n    name: \"Race\",\n    units: \"blockgroups\",\n  },\n  {\n    name: \"Elections\",\n    units: \"precincts\",\n  },\n  {\n    name: \"Environment\",\n    units: \"points\"\n  },\n  // {\n  //   name: \"Food\",\n  //   units: \"tracts\"\n  // },\n  {\n    name: \"Colleges\",\n    units: \"points\"\n  },\n  {\n    name: \"Hospitals\",\n    units: \"points\"\n  }\n];\n\nlet parts = [\n  {id:0,color:\"#0099cd\"},\n  {id:1,color:\"#ffca5d\"},\n  {id:2,color:\"#00cd99\"}\n];\nparts.forEach(part => {\n  part.hoverColor = changeColorLuminance(part.color, -0.3);\n});\n\nexport default class Map extends React.Component {\n  constructor (props) {\n    super()\n\n    this.state = {\n      mapLoaded: false,\n\n      currentColorLayer: 0,\n      currentUnitLayer: '',\n      unitLayers: {},\n      pointLayers: {},\n      mapSelection: [],\n\n      selectedElection: 0,\n      focusRace: 0,\n    }\n  }\n\n  componentDidMount() {\n    let state_configs = {\n      nc: {\n        center: [-80.1, 35.2154083],\n        zoom: 5.5\n      }\n    }\n\n    this.map = new window.mapboxgl.Map({\n      container: this.refs.map,\n      style: 'mapbox://styles/mapbox/light-v10',\n      center: state_configs.nc.center,\n      zoom: state_configs.nc.zoom,\n      attributionControl: false,\n      pitchWithRotate: false,\n      // preserveDrawingBuffer: true,\n      dragPan: true,\n      touchZoomRotate: true,\n    })\n\n    this.map.on('load', () => {\n      let geocoder = new window.MapboxGeocoder({\n        accessToken: window.mapboxgl.accessToken,\n        marker: {\n          color: 'orange'\n        },\n        mapboxgl: window.mapboxgl\n      })\n      this.map.addControl(geocoder, \"top-left\")\n\n      this.map.addControl(new window.mapboxgl.NavigationControl())\n\n      // NC state outline\n      // this.map.addSource('state_outline', {\n      //   type: \"vector\",\n      //   url: \"mapbox://mapbox.hist-pres-election-state\"\n      // })\n      // this.map.addLayer({\n      //   id: 'state_outline',\n      //   source: 'state_outline',\n      //   \"source-layer\": \"historical_pres_elections_state\",\n      //   type: 'line',\n      //   paint: {\n      //     'line-color': '#555',\n      //     'line-width': [\"case\", [\"==\", [\"get\", \"state_abbrev\"], \"NC\"], 1.5, 0]\n      //   }\n      // })\n\n      // NC congress outline\n      fetch(\"/nc-districts/nc-geo/current_districts.geojson\").then(res => res.json()).then((gj) => {\n        this.map.addSource('districts', {\n          type: \"geojson\",\n          data: gj\n        })\n        new Layer(this.map, {\n          id: 'districts',\n          source: 'districts',\n          type: 'line',\n          paint: {\n            'line-color': '#555',\n            'line-width': 1.5\n          }\n        })\n      })\n\n      // NC precincts\n      this.map.addSource('precincts', {\n        type: \"vector\",\n        url: \"mapbox://districtr.nc_precincts\"\n      })\n      let borderPrecincts = new Layer(null, {\n        id: 'precincts-borders',\n        source: 'precincts',\n        'source-layer': 'nc_precincts',\n        type: 'line',\n        paint: {\n          \"line-color\": \"#777777\",\n          \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 0, 0, 7, 1],\n          \"line-opacity\": 0.3\n        }\n      })\n      let fillPrecincts = new Layer(null, { // don't add to map right now\n        id: 'precincts',\n        source: 'precincts',\n        'source-layer': 'nc_precincts',\n        type: 'fill',\n        paint: {\n          \"fill-color\": getUnitColorProperty(parts),\n          \"fill-opacity\": 0.8\n        }\n      })\n      let cursorPrecincts = new HoverWithRadius(\n        fillPrecincts,\n        20,\n        this.setMapSelection.bind(this)\n      )\n\n      // NC blockgroups\n      this.map.addSource('blockgroups', {\n        type: \"vector\",\n        url: \"mapbox://districtr.nc_bg_blockgroups\"\n      })\n      let borderBGs = new Layer(this.map, {\n        id: 'blockgroups-borders',\n        source: 'blockgroups',\n        'source-layer': 'nc_bg_blockgroups',\n        type: 'line',\n        paint: {\n          \"line-color\": \"#777777\",\n          \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 0, 0, 7, 1],\n          \"line-opacity\": 0.3\n        }\n      })\n      let fillBGs = new Layer(this.map, {\n        id: 'blockgroups',\n        source: 'blockgroups',\n        'source-layer': 'nc_bg_blockgroups',\n        type: 'fill',\n        paint: {\n          \"fill-color\": getUnitColorProperty(parts),\n          \"fill-opacity\": 0.8\n        }\n      })\n      let cursorBGs = new HoverWithRadius(\n        fillBGs,\n        20,\n        this.setMapSelection.bind(this)\n      )\n      cursorBGs.activate()\n\n      // NC environment\n      fetch(\"/nc-districts/nc-geo/nc_industry.geojson\").then(res => res.json()).then(gj => {\n        this.map.addSource('enviro', {\n          type: \"geojson\",\n          data: gj\n        })\n        this.state.pointLayers[\"Environment\"] = new Layer(null, {\n          id: 'enviro',\n          source: 'enviro',\n          type: 'circle',\n          paint: enviroPaint\n        })\n      })\n\n      // NC colleges\n      fetch(\"/nc-districts/nc-geo/nc_colleges.geojson\").then(res => res.json()).then(gj => {\n        this.map.addSource('colleges', {\n          type: \"geojson\",\n          data: gj\n        })\n        this.state.pointLayers[\"Colleges\"] = new Layer(null, {\n          id: 'colleges',\n          source: 'colleges',\n          type: 'circle',\n          paint: {\n            'circle-radius': 4,\n            'circle-color': 'blue'\n          }\n        })\n      })\n\n      // NC hospitals\n      fetch(\"/nc-districts/nc-geo/nc_hospitals.geojson\").then(res => res.json()).then(gj => {\n        this.map.addSource('hospitals', {\n          type: \"geojson\",\n          data: gj\n        })\n        this.state.pointLayers[\"Hospitals\"] = new Layer(null, {\n          id: 'hospitals',\n          source: 'hospitals',\n          type: 'circle',\n          paint: {\n            'circle-radius': 4,\n            'circle-color': 'red'\n          }\n        })\n      })\n\n      this.setState({\n        currentUnitLayer: 'blockgroups',\n        unitLayers: {\n          blockgroups: fillBGs,\n          blockgroups_border: borderBGs,\n          blockgroups_cursor: cursorBGs,\n          precincts: fillPrecincts,\n          precincts_border: borderPrecincts,\n          precincts_cursor: cursorPrecincts\n        },\n        mapLoaded: true\n      })\n      this.paintAge()\n\n    })\n  }\n\n  setMapSelection(items) {\n    this.setState({\n      mapSelection: items\n    })\n  }\n\n  changeElection(event) {\n    const newSelection = event\n            ? event.target.value\n            : this.state.selectedElection,\n          newElection = elections[newSelection];\n\n    // also need feature to trigger this when elections are first loaded\n    this.state.unitLayers.precincts.setPaintProperty(\n      \"fill-color\",\n      electionColors(newElection[2], newElection[3])\n    )\n\n    this.setState({ selectedElection: newSelection })\n  }\n\n  changeFocus(event) {\n    const newSelection = event\n            ? event.target.value\n            : this.state.focusRace,\n          newFocus = raceGroups[newSelection];\n\n    this.state.unitLayers.blockgroups.setPaintProperty(\n      \"fill-color\",\n      densityColors(newFocus)\n    )\n\n    this.setState({ focusRace: newSelection })\n  }\n\n  paintAge() {\n    this.state.unitLayers.blockgroups.setPaintProperty(\"fill-color\", ageColors)\n    this.state.unitLayers.blockgroups.setPaintProperty(\"fill-opacity\", 0.4)\n  }\n\n  paintIncome() {\n    this.state.unitLayers.blockgroups.setPaintProperty(\"fill-color\", incomeColors)\n    this.state.unitLayers.blockgroups.setPaintProperty(\"fill-opacity\", 0.4)\n  }\n\n  paintRace() {\n    this.state.unitLayers.blockgroups.setPaintProperty(\n      \"fill-color\",\n      densityColors(raceGroups[this.state.focusRace])\n    )\n    this.state.unitLayers.blockgroups.setPaintProperty(\"fill-opacity\", 0.6)\n  }\n\n  switchLayer(layer_id) {\n    let selectLayer = dataLayers[layer_id];\n\n    if (dataLayers[this.state.currentColorLayer].units === \"points\") {\n      // remove current point layer\n      this.state.pointLayers[dataLayers[this.state.currentColorLayer].name].remove()\n    }\n\n    if (selectLayer.units === \"points\") {\n      // points file\n      this.state.pointLayers[selectLayer.name].addToMap(this.map)\n      this.setState({\n        currentColorLayer: layer_id\n      })\n    } else if (selectLayer.units === this.state.currentUnitLayer) {\n      // same units\n      this.setState({\n        currentColorLayer: layer_id\n      })\n    } else {\n      this.state.unitLayers[this.state.currentUnitLayer + \"_cursor\"].deactivate()\n      this.state.unitLayers[this.state.currentUnitLayer].remove()\n      this.state.unitLayers[this.state.currentUnitLayer + \"_border\"].remove()\n\n      this.state.unitLayers[selectLayer.units].addToMap(this.map)\n      this.state.unitLayers[selectLayer.units + \"_border\"].addToMap(this.map)\n      this.state.unitLayers[selectLayer.units + \"_cursor\"].activate()\n\n      this.setState({\n        currentUnitLayer: selectLayer.units,\n        currentColorLayer: layer_id\n      })\n    }\n\n    if (selectLayer.name === \"Age\") {\n      this.paintAge()\n    } else if (selectLayer.name === \"Income\") {\n      this.paintIncome()\n    } else if (selectLayer.name === \"Race\") {\n      this.paintRace()\n    } else if (selectLayer.name === \"Elections\") {\n      this.changeElection()\n    }\n  }\n\n  render() {\n    let activeLayer = dataLayers[this.state.currentColorLayer].name;\n\n    return <>\n      <div className=\"options\">\n        <ChooseLayers\n          labels={dataLayers}\n          switchLayer={this.switchLayer.bind(this)}\n          disabled={!this.state.mapLoaded}\n        />\n      </div>\n      <div className=\"map\" ref=\"map\">\n      </div>\n      <div className=\"legend\">\n        <div className=\"outputs\">\n          Units: {this.state.currentUnitLayer}\n          <br/>\n          {activeLayer === \"Age\" ? <AgeHistogram selected={this.state.mapSelection}/> : null}\n          {activeLayer === \"Income\" ? <IncomeHistogram selected={this.state.mapSelection}/> : null}\n          {activeLayer === \"Elections\" ?\n            <ElectionTable\n              selected={this.state.mapSelection}\n              selectedElection={this.state.selectedElection}\n              changeElection={this.changeElection.bind(this)}\n              />\n            : null}\n          {activeLayer === \"Race\" ?\n            <RaceDataBrowser\n              selected={this.state.mapSelection}\n              focusRace={this.state.focusRace}\n              changeFocus={this.changeFocus.bind(this)}\n              />\n            : null}\n          {activeLayer === \"Environment\" ? <EnvLegend selected={this.state.mapSelection}/> : null}\n          {activeLayer === \"Hospitals\" ? <MedLegend selected={this.state.mapSelection}/> : null}\n          {activeLayer === \"Colleges\" ? <UniLegend selected={this.state.mapSelection}/> : null}\n        </div>\n      </div>\n    </>\n  }\n}\n","import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport Map from './pages/Map';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <section>\n        <Map/>\n      </section>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}